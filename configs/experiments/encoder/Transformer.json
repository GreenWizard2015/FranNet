{
  "model": {
    "encoder": {
      "latent dimension": 64,
      "use downsampling": false,
      "head": {
        "downsample steps": [32, 32, 32],
        "global context": {
          "name": "v2",
          "downsample steps": [
            {"channels": 32, "kernel size": 3, "layers": 2},
            {"channels": 64, "kernel size": 3, "layers": 2},
            {"channels": 128, "kernel size": 3, "layers": 2}
          ],
          "mlp": [256, 256],
          "final activation": "relu"
        },
        "local context": {
          "layers": [
            {"name": "Patches", "patch size": 8 },
            {"name": "Reshape", "shape": [8, 8, -2] },
            {"name": "MLP", "sizes": [64], "activation": "relu" },
            {"name": "CoordsGrid" },
            {"name": "Reshape", "shape": [-1, -2] },
            {"name": "Transformer", "intermediate dim": 256, "num heads": 32, "dropout": 0.0},
            {"name": "Reshape", "shape": [8, 8, -1]}
          ]
        }
      },
      "contexts mixer": {
        "extractor": {
          "name": "interpolate",
          "mlp": [256, 256],
          "final activation": "relu",
          "dropout": 0.0
        }
      }
    }
  }
}